<!DOCTYPE html>
<html>
<head>
    <title>Subtitle Fetch Test</title>
</head>
<body>
    <h1>Subtitle Fetch Test</h1>
    <button onclick="testFetch()">Test Fetch</button>
    <button onclick="testXHR()">Test XHR</button>
    <div id="results"></div>

    <script>
        async function testFetch() {
            console.log('=== Testing fetch() ===');
            const url = 'http://localhost:5000/api/subtitles/sample-video.ko.smi';
            
            try {
                const response = await fetch(url, {
                    method: 'GET',
                    headers: {
                        'Accept': 'text/vtt,*/*',
                        'Cache-Control': 'no-cache'
                    }
                });
                
                console.log('Response status:', response.status);
                console.log('Response headers:', Object.fromEntries(response.headers.entries()));
                
                const text = await response.text();
                console.log('Response length:', text.length);
                console.log('Response preview:', text.substring(0, 200));
                
                document.getElementById('results').innerHTML += 
                    `<h3>Fetch Result:</h3>
                     <p>Status: ${response.status}</p>
                     <p>Length: ${text.length}</p>
                     <p>Preview: <pre>${text.substring(0, 200)}</pre></p>`;
                     
            } catch (error) {
                console.error('Fetch error:', error);
                document.getElementById('results').innerHTML += 
                    `<h3>Fetch Error:</h3><p>${error.message}</p>`;
            }
        }
        
        function testXHR() {
            console.log('=== Testing XMLHttpRequest ===');
            const url = 'http://localhost:5000/api/subtitles/sample-video.ko.smi';
            
            const xhr = new XMLHttpRequest();
            xhr.open('GET', url, true);
            xhr.setRequestHeader('Accept', 'text/vtt,*/*');
            xhr.setRequestHeader('Cache-Control', 'no-cache');
            
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4) {
                    console.log('XHR status:', xhr.status);
                    console.log('XHR response length:', xhr.responseText.length);
                    console.log('XHR preview:', xhr.responseText.substring(0, 200));
                    
                    document.getElementById('results').innerHTML += 
                        `<h3>XHR Result:</h3>
                         <p>Status: ${xhr.status}</p>
                         <p>Length: ${xhr.responseText.length}</p>
                         <p>Preview: <pre>${xhr.responseText.substring(0, 200)}</pre></p>`;
                }
            };
            
            xhr.send();
        }
    </script>
</body>
</html>
